TRIGGER DASHBOARD SUMMARY
---------------------------------
Основные общие источники данных:
1) youscan upload
2) google trends
3) weather data

---------------------------------
1) youscan upload
API для выгрузки всего объема упоминаний доступно только с аккаунта, 
зарезервированного до февраля 2020 года. 
При смене аккаунта эта опция больше не будет доступна.

Про создание темы:
Сначала нужно почистить ненужную тему. 
Здесь https://next.youscan.io/themes/ можно увидеть весь список и выбрать неактуальную, 
предварительно убедившись, что все данные из нее сохранены или не несут ценности. 
В настройках темы (если по ней кликнуть) будет пункт Удаление. 
Удалять полностью, чтобы данные не мешались. 

Дальше нужно создать запрос - там все подробно объясняют. 
При создании темы его можно потюнить, чтобы было мусора поменьше. 
И выставить фильтры, какие тебе нужны. Страна там, язык, соцсеть, вот это все. 

Дальше юскан соберет данные за ближайший месяц. 
Их можно выгрузить через апи 
(например, так http://104.214.221.250:9999/tree/Tools/vk_upload/youscan upload.ipynb) 
или файликом через интерфейс.

Собирать данные ручками за какой-то промежуток времени можно через "Сбор истории".

https://help.youscan.io/ru/articles/461541-как-работает-сбор-истории-и-какие-есть-лимиты

Глубоких сборов ограниченное количество и их нужно согласовывать. 
Глубинный сбор - за пять лет. Стоит Многаденег и собирается под конкретную задачу.

Нюансов и ограничений по выгрузке через api по сути нет. Частичная довыгрузка аккуратно реализована в 
http://104.214.221.250:9999/tree/Trigger_Dashboard_MMX_2020/uploading_lib.py (функция youscan_upload())

К сожалению, не существует документации на самы выгрузку.
(и я так и не смогла добиться внятного ответа от самих юскановцев, будут ли они ее составлять)
Основные используемые поля:
-- 'author.age','author.gender', 'author.url', 'city', 'country', 'region': 
	тут все понятно, это полезные данные о пользователях соцсетей.
-- 'autoCategories', 'sentiment': 
	это важные составляющие работы команды youscan. 
	autoCategories позволяет узнать, к какой категории относится пост. 
	'wom', 'article', 'commercial', 'recipe', 'promotion', 'donation', 
	'socialPromo', 'listBeta', 'captionBeta', 'giveaway', 'vacancy'
	И их подтипы. 
	Самое полезное для нас - wom, word of mouth, личные высказывания, без рекламы, рецептов и т.д.
-- 'fullText', 'text': 
	fullText содержит весь текст поста, 
	text - кусок длиной не более 100 символов, содержащий ключевые слова из запроса
-- 'id', 'postId', 'parentPostId': 
	id - это внутриюскановский идентификатор поста, 
	postId - идентификатор внутри соцсети, 
	parentPostId - идентификатор поста-родителя. Прародителя. И это неудобно.
-- 'published': время публикации поста
-- 'source': ссылка на источник, в котором было найдено упоминание

---------------------------------
2) Google trends

А вот здесь нюнсов много. 
Начнем со скрипта выгрузки: http://104.214.221.250:9999/tree/Tools/Google%20Trends.ipynb
Он составлен на основе полуофициального api и бибилотеки pytrends 
(осторожно, она иногда немного отстает от версии питона, сразу обновляться лучше не надо)

Параметр timeframe принимает ограниченное количество значений. Что важно про них знать,
так это то, что выгрузка отличается для разных масштабов. 
 5-y (5 лет) - разбита на недели и слегка отстает от сегодняшней даты.
По всей видимости, у гугла работают какие-то механизмы усреднения и индексации (черт их знает),
поэтому данных за последнюю пару недель там не будет, а последняя цифра может меняться.
Данные за несколько месяцев выдаются по дням и если общий объем данных невелик, то из-за сэмплирования 
(гугл никогда не отдаст тебе всё, оставь надежду)
последовательные независимые выгрузки могут довольно сильно отличаться.

Также нельзя производить много (несколько сотен) запросов подряд - гугл забанит ip. Но не навсегда, а до следующего дня. 
Но все равно неприятно.

Еще в какой-то момент чуть поменялся формат возвращаемой даты и за этим тоже надо следить.

В целом мораль такова: так как это неофициальное api, гугл полностью в своем праве менять что угодно,
никого не предупреждая.

---------------------------------
3) weather data

Мы берем данные с сайта https://darksky.net/, у них есть удобное и хорошо задокументированное api... Было. 
Здесь мы тоже заскочили в последний вагон, потому что их купили Apple и прикрыли лавочку.
Api будет продолжать работать до конца 2021 года.
Наш работающий скрипт для выгрузки находится по ссылке 
http://104.214.221.250:9999/tree/Tools/DarkSKY_API_Forecasting.ipynb
Функции для выгрузки недостающих данных здесь:
http://104.214.221.250:9999/tree/Trigger_Dashboard_MMX_2020/uploading_lib.py
Первые 1000 обращений к серверу каждые сутки - бесплатные. Обращение - это выгрузка одного дня для одного города. 
Дальше - платно, но каждый запрос стоит копейки, 
главное - не делать сотни тысяч обращений без четкого понимания, что это необходимо.
В файле cities_100.csv - города с населением более 100тыс.жителей.

---------------------------------

